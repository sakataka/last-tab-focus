# Last Tab Focus Extension - Testing Guide

## Chrome拡張機能として読み込む手順

### 1. Chromeでデベロッパーモードを有効化
1. Chrome ブラウザで `chrome://extensions/` を開く
2. 右上の「デベロッパーモード」をONにする

### 2. 拡張機能を読み込む
1. 「パッケージ化されていない拡張機能を読み込む」をクリック
2. このプロジェクトのディレクトリ（manifest.jsonがあるフォルダ）を選択

### 3. 基本動作テスト

#### テスト手順
1. `test-basic.html` をブラウザで開く
2. 複数のタブを開く（テストページのボタンを使用）
3. タブ間を切り替えて履歴を作成
4. アクティブなタブを閉じる
5. 直前にフォーカスしていたタブにフォーカスが移ることを確認

#### 確認項目
- [ ] 拡張機能がエラーなく読み込まれる
- [ ] タブを開いても問題ない
- [ ] タブ間の切り替えが正常に動作する
- [ ] タブを閉じたときに前のタブにフォーカスが移る
- [ ] ブラウザコンソールにエラーがない
- [ ] 拡張機能のログが出力される

### 4. 複数ウィンドウテスト

#### テスト手順
1. 複数のブラウザウィンドウを開く
2. 各ウィンドウで複数タブを開く
3. ウィンドウ間でタブを切り替え
4. 各ウィンドウでタブクローズをテスト

#### 確認項目
- [ ] ウィンドウ毎にタブ履歴が管理される
- [ ] 他のウィンドウのタブに誤ってフォーカスしない
- [ ] ウィンドウを閉じても他のウィンドウの動作に影響しない

### 5. エラーハンドリングテスト

#### テスト手順
1. 大量のタブを開く（20個以上）
2. 素早くタブを開閉する
3. ウィンドウを急に閉じる
4. システムの負荷をかけた状態でテスト

#### 確認項目
- [ ] メモリリークが発生しない
- [ ] パフォーマンスが著しく低下しない
- [ ] 予期しないエラーが発生しない
- [ ] 履歴が適切にクリーンアップされる

### 6. ログの確認

Chrome DevToolsのコンソールで以下のログを確認：
```
[timestamp] [INFO] Chrome tabs API available
[timestamp] [INFO] Tab activated: [tabId] in window: [windowId]
[timestamp] [INFO] Tab removed: [tabId] Window closing: false
[timestamp] [INFO] Switched focus to tab: [tabId] in window: [windowId]
```

### トラブルシューティング

#### よくある問題
1. **拡張機能が読み込まれない**
   - manifest.jsonの構文エラーを確認
   - ファイルパスが正しいか確認

2. **タブフォーカスが切り替わらない**
   - コンソールでエラーログを確認
   - tabs権限が正しく設定されているか確認

3. **パフォーマンスの問題**
   - 履歴サイズの制限を確認
   - 無効なタブの自動除去を確認

### 期待される動作

正常に動作している場合：
- タブクローズ時に直前のタブにフォーカスが移る
- Chrome標準の動作より使いやすい
- ユーザーの作業効率が向上する
- 予期しない動作やエラーが発生しない